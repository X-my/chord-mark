import { CM, CCS, CS } from '../../../../../src/components/shortcuts';
import TabbedChordMark from '../../../../../src/components/TabbedChordMark';

# Объявление ключа

## Строки объявления ключа

Возможно объявить ключ любой части песни с помощью ключевого слова `key`:

<TabbedChordMark src={'key C\nC F G C'} />

Если происходит изменение ключа перед изменением раздела, то объявите его непосредственно в новом разделе, или на строке, непосредственно предшествующей метке раздела,
чтобы избежать того, что он будет повторяться для предыдущего раздела при использовании функции автоматического повторения аккордов.

Кроме того, что объявление одного или нескольких ключей приносит, по крайней мере, 3 преимущества.

### 1/ Автоматическая транспозиция

Первое преимущество - на мой взгляд, одна из самых крутых функций <CM />!
Всегда, когда происходит изменение ключа в песне, и при использовании автоматического повторения аккордов между разделами, <CM /> автоматически транспонирует повторяемые аккорды на основе нового объявления ключа.
Смотрите пример ниже:

<TabbedChordMark
	src={
		'key C\n#v\nDm7 G7 C %\nThe first verse is in the key of C\n\nkey G\n#v\nAnd the second one in the key of G!'
	}
/>

Базовый ключ, от которого происходит транспозиция, всегда является первым, явно объявленным, поэтому убедитесь, что всегда определяете ключ перед первой строкой аккордов.

### 2/ Правильное отображение случайных знаков

Второе преимущество связано с отображением случайных знаков (`#` и `b`).
Если ваш исходный файл содержит смешанные случайные знаки, то объявление ключа позволит <CM/> автоматически нормализовать случайные знаки, выбирая подходящий символ

<TabbedChordMark
	src={
		'#v\nkey C#m\nC#m7 Ab7\n_ What will you do when you get _lonely?\nC#m7.. C. D. E.. E7..\n_ No one _waiting _by your _side _'
	}
/>

Обратите внимание, что если вы не объявите ключ, <CM/> будет пытаться автоматически определить его на основе аккордов, используемых в песне.
Хотя это должно работать разумно для простых песен, оно, вероятно, не сработает для более сложных случаев.
Так что в качестве лучшей практики рекомендуется всегда явно объявлять ключ.

Случайные знаки также правильно выбираются, если песня содержит несколько ключей:

<TabbedChordMark
	src={
		'#v\nkey C#m\nC#m7 Ab7\n_ What will you do when you get _lonely?\nC#m7.. C. D. E.. E7..\n_ No one _waiting _by your _side _\n\n#c\nkey Dm\nDm.. Bb..\nLayla_\nC.. Dm.. Dm.. A#..\n_Got me on my _knees, Layla'
	}
/>

Когда транспонируя в режиме случайных знаков `auto`, <CM/> пытается быть умным и избегать [теоретических ключей](https://en.wikipedia.org/wiki/Theoretical_key), которые не используются в практике.
Например, транспонирование вниз на полтона для `Layla` приведет к ключу `C#m` вместо `Dbm` для куплета. Опять же, обратите внимание, что используются подходящие случайные знаки для каждого ключа.

<TabbedChordMark
	src={
		'#v\nkey C#m\nC#m7 Ab7\n_ What will you do when you get _lonely?\nC#m7.. C. D. E.. E7..\n_ No one _waiting _by your _side _\n\n#c\nkey Dm\nDm.. Bb..\nLayla_\nC.. Dm.. Dm.. A#..\n_Got me on my _knees, Layla'
	}
	options={{ transposeValue: -1 }}
/>

### 3/ Гармонический анализ

Третье преимущество использования ключей лежит в способности <CM/> помочь с гармоническим анализом, отображая символы аккордов как [римские цифры](https://en.wikipedia.org/wiki/Roman_numeral_analysis).
Это может быть сделано только если ключ явно установлен, иначе все символы будут отображаться как `I`, `i` или `?`.
Подход к преобразованию аккордов из нот в символы римских цифр очень прост и наивен: на основе объявленного ключа, <CM/> будет просто обнаруживать, являются ли аккорды песни диатоническими к ключу,
или диатоническими к параллельному мажору/минору ключу (например, "заимствованные" аккорды).
Конечно, есть гораздо больше к гармоническому анализу, чем этот простой подход, и я надеюсь расширить возможности <CM/> с более функциональностью в будущем.

<TabbedChordMark
	src={
		'key Em\n6/8\nEm D. C.\n_ Forever trusting _who we are\nG.  B7. Em %\n_ and _nothing else _matters'
	}
	options={{ symbolType: 'roman' }}
/>

Обратите внимание, что:

-   символы, диатонические к ключам, отображаются с цветным фоном
-   заимствованные аккорды отображаются с чуть более темным фоном
-   неидентифицированные аккорды отображаются без фона

<TabbedChordMark
	src={'key C\nC/E Dm7/F Fm Gm Ab7'}
	options={{ symbolType: 'roman' }}
/>

Если вы не уверены в ключе, просто попробуйте несколько кандидатов! Вы сможете сразу увидеть, если песня имеет много диатонических аккордов для этого ключа.
И если это так, то данный ключ может быть хорошим кандидатом.
